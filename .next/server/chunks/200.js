exports.id=200,exports.ids=[200],exports.modules={16953:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>k,metadata:()=>i,viewport:()=>j});var d=c(75338),e=c(42003),f=c.n(e);c(82704);var g=c(86802),h=c(84105);let i={title:"极简聊天室 - Minimalist Chat",description:"一个简洁、高效、流畅的现代聊天应用",keywords:["聊天","即时通讯","简约设计","流畅体验"],authors:[{name:"Minimalist Chat Team"}],creator:"Minimalist Chat",publisher:"Minimalist Chat",robots:"index, follow",openGraph:{title:"极简聊天室",description:"简洁、高效、流畅的现代聊天应用",type:"website",locale:"zh_CN"},twitter:{card:"summary_large_image",title:"极简聊天室",description:"简洁、高效、流畅的现代聊天应用"},manifest:"/manifest.json",appleWebApp:{capable:!0,statusBarStyle:"default",title:"极简聊天室"},formatDetection:{telephone:!1}},j={width:"device-width",initialScale:1,maximumScale:1,userScalable:!1,themeColor:[{media:"(prefers-color-scheme: light)",color:"#007AFF"},{media:"(prefers-color-scheme: dark)",color:"#0A84FF"}],viewportFit:"cover"};async function k({children:a}){let b=(await (0,g.b3)()).get("x-nonce")??void 0;return(0,d.jsxs)("html",{lang:"zh-CN",children:[(0,d.jsxs)("head",{children:[(0,d.jsx)("meta",{name:"mobile-web-app-capable",content:"yes"}),(0,d.jsx)("meta",{name:"apple-mobile-web-app-status-bar-style",content:"default"}),(0,d.jsx)("meta",{name:"format-detection",content:"telephone=no"}),(0,d.jsx)("link",{rel:"apple-touch-icon",href:"/icon-192.png"}),(0,d.jsx)("link",{rel:"manifest",href:"/manifest.json"}),(0,d.jsx)(h.default,{id:"pre-init",nonce:b,strategy:"beforeInteractive",children:"window.__APP__ = window.__APP__ || {};"})]}),(0,d.jsx)("body",{className:`${f().className} antialiased`,children:a})]})}},26665:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,27532,23))},29407:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,81170,23)),Promise.resolve().then(c.t.bind(c,23597,23)),Promise.resolve().then(c.t.bind(c,36893,23)),Promise.resolve().then(c.t.bind(c,89748,23)),Promise.resolve().then(c.t.bind(c,6060,23)),Promise.resolve().then(c.t.bind(c,7184,23)),Promise.resolve().then(c.t.bind(c,69576,23)),Promise.resolve().then(c.t.bind(c,73041,23)),Promise.resolve().then(c.t.bind(c,51384,23))},41697:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\zz113\\\\Desktop\\\\聊天\\\\app\\\\error.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\zz113\\Desktop\\聊天\\app\\error.tsx","default")},52088:(a,b,c)=>{"use strict";function d(a){let b=new Uint8Array(a),c="";for(let a=0;a<b.byteLength;a++)c+=String.fromCharCode(b[a]);return btoa(c)}function e(a){let b=atob(a),c=new Uint8Array(b.length);for(let a=0;a<b.length;a++)c[a]=b.charCodeAt(a);return c.buffer}function f(...a){let b=new Uint8Array(a.reduce((a,b)=>a+b.byteLength,0)),c=0;for(let d of a)b.set(new Uint8Array(d),c),c+=d.byteLength;return b.buffer}function g(a){let b=new Uint8Array(a);return crypto.getRandomValues(b),b}async function h(){return await crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey","deriveBits"])}async function i(){return await crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey","deriveBits"])}async function j(a){return await crypto.subtle.exportKey("jwk",a)}async function k(a){return await crypto.subtle.exportKey("jwk",a)}async function l(a){return await crypto.subtle.importKey("jwk",a,{name:"ECDH",namedCurve:"P-256"},!0,[])}async function m(a){return await crypto.subtle.importKey("jwk",a,{name:"ECDH",namedCurve:"P-256"},!0,["deriveKey","deriveBits"])}async function n(a,b){return await crypto.subtle.deriveBits({name:"ECDH",public:b},a,256)}async function o(a,b,c,d=32){let e=await crypto.subtle.importKey("raw",a,"HKDF",!1,["deriveBits"]);return await crypto.subtle.deriveBits({name:"HKDF",hash:"SHA-256",salt:b,info:new TextEncoder().encode(c)},e,8*d)}async function p(a,b,c,d){let e=await crypto.subtle.importKey("raw",a,{name:"AES-GCM"},!1,["encrypt"]),f=new Uint8Array(c),g=new Uint8Array(b),h=d?new Uint8Array(d):void 0;return new Uint8Array(await crypto.subtle.encrypt({name:"AES-GCM",iv:f,additionalData:h},e,g))}async function q(a,b,c,d){let e=await crypto.subtle.importKey("raw",a,{name:"AES-GCM"},!1,["decrypt"]),f=new Uint8Array(c),g=new Uint8Array(b),h=d?new Uint8Array(d):void 0;return new Uint8Array(await crypto.subtle.decrypt({name:"AES-GCM",iv:f,additionalData:h},e,g))}async function r(a){let b=await j(a),c=new TextEncoder().encode(JSON.stringify(b));return d(await crypto.subtle.digest("SHA-256",c)).slice(0,16)}async function s(a,b,c="encrypt"){let d=`message-${c}-${b}`;return await o(a,new ArrayBuffer(0),d,32)}async function t(a,b){return await o(a,new ArrayBuffer(0),`media-${b}`,32)}c.d(b,{G5:()=>p,GR:()=>m,Gg:()=>g,Hi:()=>n,KG:()=>l,Ms:()=>e,NA:()=>f,Yi:()=>d,c2:()=>i,dZ:()=>h,ds:()=>j,lI:()=>t,oH:()=>s,sM:()=>o,sQ:()=>q,xu:()=>k,zJ:()=>r})},54399:(a,b,c)=>{"use strict";c.d(b,{A:()=>m,P:()=>n});var d=c(21124),e=c(49503),f=c(92667),g=c(89497),h=c(48332),i=c(89710),j=c(68324),k=c(22842),l=c(87788);function m({isEnabled:a,isEstablishing:b,error:c,onToggle:k,className:m}){return(0,d.jsx)(f.N,{mode:"wait",children:(0,d.jsx)(e.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:(0,l.cn)("flex items-center justify-center px-3 py-2 rounded-lg border",a&&!c&&"bg-green-50 border-green-200",b&&"bg-blue-50 border-blue-200",c&&"bg-red-50 border-red-200",!a&&!b&&!c&&"bg-gray-50 border-gray-200",m),children:b?(0,d.jsxs)(e.P.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center space-x-2 text-blue-600",children:[(0,d.jsx)(g.A,{className:"w-4 h-4 animate-spin"}),(0,d.jsx)("span",{className:"text-sm font-medium",children:"正在建立加密连接..."})]}):c?(0,d.jsxs)(e.P.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center space-x-2 text-red-600",children:[(0,d.jsx)(h.A,{className:"w-4 h-4"}),(0,d.jsx)("span",{className:"text-sm font-medium",children:"加密连接失败"})]}):a?(0,d.jsxs)(e.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"flex items-center space-x-2 text-green-600",children:[(0,d.jsx)(i.A,{className:"w-4 h-4"}),(0,d.jsx)("span",{className:"text-sm font-medium",children:"端到端加密已启用"})]}):(0,d.jsxs)(e.P.button,{initial:{opacity:0},animate:{opacity:1},whileHover:{scale:1.02},whileTap:{scale:.98},onClick:k,className:"flex items-center space-x-2 text-gray-600 hover:text-blue-600 transition-colors",children:[(0,d.jsx)(j.A,{className:"w-4 h-4"}),(0,d.jsx)("span",{className:"text-sm font-medium",children:"启用端到端加密"})]})},`${a}-${b}-${c}`)})}function n({isEnabled:a,isEstablishing:b}){return(0,d.jsx)("div",{className:"flex items-center space-x-1",children:(0,d.jsx)(f.N,{mode:"wait",children:a?(0,d.jsxs)(e.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"flex items-center space-x-1 text-green-600",children:[(0,d.jsx)(k.A,{className:"w-3 h-3"}),(0,d.jsx)("span",{className:"text-xs font-medium",children:"加密"})]},"enabled"):b?(0,d.jsxs)(e.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"flex items-center space-x-1 text-blue-600",children:[(0,d.jsx)(g.A,{className:"w-3 h-3 animate-spin"}),(0,d.jsx)("span",{className:"text-xs font-medium",children:"连接中"})]},"establishing"):(0,d.jsxs)(e.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"flex items-center space-x-1 text-gray-400",children:[(0,d.jsx)(j.A,{className:"w-3 h-3"}),(0,d.jsx)("span",{className:"text-xs font-medium",children:"未加密"})]},"disabled")})})}},62070:(a,b,c)=>{"use strict";c.d(b,{f:()=>f});var d=c(38301),e=c(64714);function f(a={}){let{participants:b=[],autoEnable:c=!1}=a,[g,h]=(0,d.useState)(e.x.getStatus()),i=(0,d.useCallback)(async()=>{if(0===b.length)throw Error("需要指定参与者才能启用加密");try{await e.x.enable(b)}catch(a){throw console.error("启用加密失败:",a),a}},[b]),j=(0,d.useCallback)(()=>{e.x.disable()},[]),k=(0,d.useCallback)(async(a,b)=>{if(!g.isEnabled||!g.sessionId)throw Error("加密未启用");return await e.x.encryptMessage(g.sessionId,a,b)},[g.isEnabled,g.sessionId]),l=(0,d.useCallback)(async a=>await e.x.decryptMessage(a),[]),m=(0,d.useCallback)(a=>e.x.isEncryptedMessage(a),[]);return{isEnabled:g.isEnabled,isEstablishing:g.isEstablishing,...void 0!==g.sessionId?{sessionId:g.sessionId}:{},...void 0!==g.error?{error:g.error}:{},...void 0!==g.lastActivity?{lastActivity:g.lastActivity}:{},enable:i,disable:j,encryptMessage:k,decryptMessage:l,isEncryptedMessage:m}}},64714:(a,b,c)=>{"use strict";c.d(b,{x:()=>f});var d=c(52088);class e{async enable(a){try{this.updateStatus({isEstablishing:!0,error:void 0});let b=this.generateSessionId(),c=await this.generateSharedKey(),d={id:b,participants:a,sharedKey:c,createdAt:new Date,lastActivity:new Date,messageCount:0,isActive:!0};return this.sessions.set(b,d),this.updateStatus({isEnabled:!0,isEstablishing:!1,sessionId:b,lastActivity:new Date}),console.log("\uD83D\uDD10 端到端加密已启用"),b}catch(a){throw this.updateStatus({isEstablishing:!1,error:a instanceof Error?a.message:"启用加密失败"}),a}}disable(){this.sessions.clear(),this.updateStatus({isEnabled:!1,isEstablishing:!1,sessionId:void 0,error:void 0}),console.log("\uD83D\uDD13 端到端加密已禁用")}async encryptMessage(a,b,c){let e=this.sessions.get(a);if(!e||!e.isActive)throw Error("加密会话不存在或已失效");try{let f=(0,d.Gg)(12),g=new TextEncoder().encode(b),h=await (0,d.G5)(e.sharedKey,g,f);return e.messageCount++,e.lastActivity=new Date,{sessionId:a,ciphertext:(0,d.Yi)(h.buffer.slice(h.byteOffset,h.byteOffset+h.byteLength)),iv:(0,d.Yi)(f.buffer.slice(f.byteOffset,f.byteOffset+f.byteLength)),timestamp:Date.now(),messageId:this.generateMessageId(),senderId:c}}catch(a){throw Error(`消息加密失败: ${a instanceof Error?a.message:"未知错误"}`)}}async decryptMessage(a){let b=this.sessions.get(a.sessionId);if(!b||!b.isActive)throw Error("加密会话不存在或已失效");try{let c=(0,d.Ms)(a.ciphertext),e=(0,d.Ms)(a.iv),f=await (0,d.sQ)(b.sharedKey,new Uint8Array(c),new Uint8Array(e));return b.lastActivity=new Date,new TextDecoder().decode(f)}catch(a){throw Error(`消息解密失败: ${a instanceof Error?a.message:"未知错误"}`)}}getStatus(){return{...this.status}}subscribe(a){return this.listeners.add(a),()=>this.listeners.delete(a)}isEncryptedMessage(a){return a&&"object"==typeof a&&a.sessionId&&a.ciphertext&&a.iv}getActiveSessions(){return Array.from(this.sessions.values()).filter(a=>a.isActive)}cleanupExpiredSessions(a=864e5){let b=Date.now();for(let[c,d]of this.sessions.entries())b-d.lastActivity.getTime()>a&&(d.isActive=!1,console.log("\uD83D\uDDD1️ 清理过期会话"))}updateStatus(a){this.status={...this.status,...a},this.listeners.forEach(a=>a(this.status))}generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}generateMessageId(){return`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}async generateSharedKey(){let a=(0,d.Gg)(32),b=new Uint8Array(a.length);return b.set(a),b.buffer}constructor(){this.sessions=new Map,this.status={isEnabled:!1,isEstablishing:!1},this.listeners=new Set}}let f=new e},77731:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>e});var d=c(21124);function e({error:a,reset:b}){return console.error(a),(0,d.jsxs)("div",{className:"p-4",children:["出错了：",a.message,(0,d.jsx)("button",{className:"ml-2 underline",onClick:b,children:"重试"})]})}},79781:(a,b,c)=>{Promise.resolve().then(c.bind(c,41697))},82704:()=>{},87788:(a,b,c)=>{"use strict";c.d(b,{cn:()=>f});var d=c(43249),e=c(58829);function f(...a){return(0,e.QP)((0,d.$)(a))}},89655:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,54160,23)),Promise.resolve().then(c.t.bind(c,31603,23)),Promise.resolve().then(c.t.bind(c,68495,23)),Promise.resolve().then(c.t.bind(c,75170,23)),Promise.resolve().then(c.t.bind(c,77526,23)),Promise.resolve().then(c.t.bind(c,78922,23)),Promise.resolve().then(c.t.bind(c,29234,23)),Promise.resolve().then(c.t.bind(c,12263,23)),Promise.resolve().then(c.bind(c,82146))},91817:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,14702,23))},92933:(a,b,c)=>{Promise.resolve().then(c.bind(c,77731))}};