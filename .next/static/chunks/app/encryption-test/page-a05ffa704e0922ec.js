(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[501],{5385:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var a=t(5155),r=t(2115),l=t(5947),c=t(6184),i=t(7975),n=t(1526);function d(){let[e,s]=(0,r.useState)(""),[t,d]=(0,r.useState)(""),[o,m]=(0,r.useState)(""),[x,g]=(0,r.useState)([]),{isEnabled:h,isEstablishing:u,error:p,enable:b,disable:y,encryptMessage:N,decryptMessage:j,isEncryptedMessage:f}=(0,c.f)({participants:["test-user-1","test-user-2"],autoEnable:!1}),v=async()=>{let e=[];try{try{await b(),e.push({test:"启用加密",result:!0,message:"加密系统启用成功"})}catch(s){e.push({test:"启用加密",result:!1,message:"启用失败: ".concat(s instanceof Error?s.message:"未知错误")})}if(h)try{let s=await N("这是一条测试消息 \uD83D\uDD10","test-user-1");d(JSON.stringify(s,null,2)),e.push({test:"消息加密",result:!0,message:"消息加密成功"})}catch(s){e.push({test:"消息加密",result:!1,message:"加密失败: ".concat(s instanceof Error?s.message:"未知错误")})}if(t)try{let s=JSON.parse(t),a=await j(s);m(a),e.push({test:"消息解密",result:!0,message:'解密成功: "'.concat(a,'"')})}catch(s){e.push({test:"消息解密",result:!1,message:"解密失败: ".concat(s instanceof Error?s.message:"未知错误")})}if(t){let s=JSON.parse(t),a=f(s);e.push({test:"加密检测",result:a,message:a?"正确识别加密消息":"未能识别加密消息"})}let s=n.x.getActiveSessions();e.push({test:"会话管理",result:s.length>0,message:"活跃会话数量: ".concat(s.length)})}catch(s){e.push({test:"测试执行",result:!1,message:"测试执行失败: ".concat(s instanceof Error?s.message:"未知错误")})}g(e)},w=async()=>{if(e.trim())try{if(h){let s=await N(e,"test-user-1");d(JSON.stringify(s,null,2))}else d("加密未启用，无法加密消息")}catch(e){d("加密失败: ".concat(e instanceof Error?e.message:"未知错误"))}},E=async()=>{if(t)try{let e=JSON.parse(t),s=await j(e);m(s)}catch(e){m("解密失败: ".concat(e instanceof Error?e.message:"未知错误"))}};return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-4",children:(0,a.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-lg p-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"\uD83D\uDD10 Telegram 风格加密系统测试"}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-3",children:"加密状态"}),(0,a.jsx)(i.A,{isEnabled:h,isEstablishing:u,error:null!=p?p:"",onToggle:h?y:b})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-3",children:"功能测试"}),(0,a.jsx)("div",{className:"flex space-x-4",children:(0,a.jsx)("button",{onClick:v,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"运行完整测试"})})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-3",children:"消息测试"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"测试消息"}),(0,a.jsx)("input",{type:"text",value:e,onChange:e=>s(e.target.value),placeholder:"输入要加密的消息...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsx)("button",{onClick:w,disabled:!h||!e.trim(),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"加密消息"}),(0,a.jsx)("button",{onClick:E,disabled:!t,className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"解密消息"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-md font-semibold text-gray-800 mb-2",children:"加密消息"}),(0,a.jsx)("div",{className:"bg-gray-100 p-3 rounded-lg",children:(0,a.jsx)("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap",children:t||"暂无加密消息"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-md font-semibold text-gray-800 mb-2",children:"解密消息"}),(0,a.jsx)("div",{className:"bg-gray-100 p-3 rounded-lg",children:(0,a.jsx)("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap",children:o||"暂无解密消息"})})]})]}),x.length>0&&(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-3",children:"测试结果"}),(0,a.jsx)("div",{className:"space-y-2",children:x.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg ".concat(e.result?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:[(0,a.jsx)("span",{className:"font-medium text-gray-800",children:e.test}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-sm ".concat(e.result?"text-green-600":"text-red-600"),children:e.result?"✅ 通过":"❌ 失败"}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:e.message})]})]},s))})]})]})})})}},9524:(e,s,t)=>{Promise.resolve().then(t.bind(t,5385))}},e=>{e.O(0,[56,891,406,441,493,358],()=>e(e.s=9524)),_N_E=e.O()}]);